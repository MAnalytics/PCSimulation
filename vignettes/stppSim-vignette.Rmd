---
title: "An R package for synthesizing spatiotemporal point patterns for social and life science research - A user guide"

author: |
  | Monsuru Adepeju^[Big Data Centre, Manchester Metropolitan University, Manchester, M156BH, UK, m.adepeju@mmu.ac.uk]
  | Meng Le Zhang^[Interdisciplinary Centre of Social Sciences, University of Sheffield, S14DP, UK, mengle.zhang@sheffield.ac.uk] 
  
date: |
  | `Date:`
  | ``r Sys.Date()``

#output:
  #pdf_vignette
  
output:
  pdf_document

toc:
  true

number_sections: 
  yes
    
linestretch: 
  1.5
  
fontsize: 
  16pt

#header-includes:
 # - \usepackage{leading}
  #- \leading{18}
  
#dev: png
#output:
  #word_document: default
  #always_allow_html: yes
#  pdf_document: default
always_allow_html: yes
#fig_caption: yes
bibliography: references.bib

abstract: Generates artificial spatio-temporal point patterns (stpp) by integrating microsimulation and agent-based models. Allows a user to define the movement properties of a set of "walkers" (an agents) distributed across a spatially configured landscape. The interaction of the walkers (be it human offenders in a crime analysis, foraging animals in a Wildlife study, or carriers in disease transmission) with their environment results in advent of new events, whose spatiotemporal (ST) signatures are measurable at the global levels. These signatures can be used in ST model testing and evaluation across wide variety of fields in social and life sciences.

vignette: >
  %\VignetteIndexEntry{An R package for synthesizing spatiotemporal point patterns for social and life science research - A user guide}
  %\VignetteEngine{knitr::rmarkdown}
  \usepackage[utf8]{inputenc}
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

```{r functions, include=FALSE}
# A function for captioning and referencing images
fig <- local({
  i <- 0
  ref <- list()
  list(
    cap=function(refName, text) {
      i <<- i + 1
      ref[[refName]] <<- i
      paste("Figure ", i, ": ", text, sep="")
    },
    ref=function(refName) {
      ref[[refName]]
    })
})
```

## Introduction

In many research cases, access to fine-grained spatially and temporally stamped point data have been severely restricted due to privacy concerns. As an alternative, synthesized data which mimic the real-life point pattern have been utilized in a wide range of research context. The `R-stppSim` package is designed for synthesizing point patterns within a defined landscape. The package combining microsimulation and agent-based models, allowing a user to construct movement characteristics of `walkers` (i.e., agents) across landscape. As the `walkers` interact with their environment, new cases of events originate - the cumulative of which produces spatiotemporal signatures at the global levels. These signatures can be utilized for testing and evaluation of spatiotemporal models.

The package contains two primary functions for synthesizing artificial `stpp` data. They are: `psim_artif` and `psim_real`. The `psim_artif` synthesize point pattern from scratch. In other words, given the landscape, the movement characteristics `walkers` are defined entirely by the user. On the other hand, `psim_real` synthesizes point pattern from a sample (sparse) real point data. The function learns certain properties of the sample data, and then configures the behaviours of the `walkers` as they move across the landscape. The potential application fields `stppSim` include criminology and epidemiology studies.


### Properties of a walker.

The following are the key properties (parameters) that control the behaviours of a walker:

1. Origins (`coords`) - A set of xy coordinates serving as the initial location of the walkers. These are the origins, such as homes of human offenders.
2. Movement (`transition matrix`) - An in-built stochastic property that controls the direction and the transition states of a walker. At any instant, a walker can assume one of the two state, namely; an exploratory and a performance state (See the manual for details).
3. Spatial threshold (`s_threshold`) - This is the perception range of a walker at any point in time. The range is generally updated as a walker moves to a new location. The default value is 250m.
4. Steps (`step_length`) - The maximum step taken by a walker at a time. Default value is 20m.

### Landscape

The boundary shapefile (`poly`) defines the extent of a landscape which can be of two types: 

1. `Retricted` - Contains features that restrict the movement of walkers across the landscape. Different classes of feature can have varying resistance levels. For example, a gated property may be harder (high resistance) to burgle compared to an open one (low resistance).  

2. `Unrestricted` - Contains no features or all features has zero resistance level.

## Spatiotemporal point patterns

The following steps demonstrate how `stppSim` package can be used to simulate spatiotemporal point patterns:

### Install the package from `CRAN`

From an R console, type:

```{r eval=FALSE, message=FALSE, warning=FALSE}
#install.packages("stppSim")
library(stppSim)
```

To install the developmental version of the package, use the follow codes:

```{r eval=FALSE, message=FALSE, warning=FALSE}
#install.packages("stppSim")
remotes::install_github("MAnalytics/stppSim")
library(stppSim)
```

Note: `remotes` is an extra package that needed to be installed prior to the running of this code. 


### STPP Simulation from Scratch

Run the following codes:

```{r eval=FALSE, message=FALSE, warning=FALSE}
#xxx
head(data)
```

### STPP Simulation from sample dataset

Here, we are going to use a small sample of a data to simulate the full dataset. We will then compare the real full data with the simulated data.

```{r eval=FALSE, message=FALSE, warning=FALSE}
#load data
data(camden_theft)

#let's sample 20% of the data

#
```

We are going to compare real (full) data and the simulated one in terms of their spatial and temporal characteristics. Recall that a user would have no idea of case count. So, the number to simulate is left to the discretion of the use. You can infer the potential size from any available data from previus years.
